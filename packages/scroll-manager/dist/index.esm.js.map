{"version":3,"file":"index.esm.js","sources":["../index.js"],"sourcesContent":["import EventEmitter from '@okiba/event-emitter'\nimport EventManager from '@okiba/event-manager'\nimport SizesCache from '@okiba/sizes-cache'\nimport {lerp} from '@okiba/math'\n\n\nexport default new class ScrollManager extends EventEmitter {\n  constructor() {\n    super()\n\n    this.targetY = this.lerpY =  window.scrollY || window.pageYOffset\n\n    this.emit('scroll', {y: this.targetY, delta: 0, acceleration: 0})\n    this.listen()\n  }\n\n  // Puo essere tolto metodo\n  disable() {\n    if (!this.isEnabled) return\n    this.isEnabled = false\n  }\n\n  enable() {\n    if (this.isEnabled) return\n    this.isEnabled = true\n  }\n\n  onRaf = () => {\n    if (!this.isEnabled || this.lerpY === this.targetY) return\n\n    this.deltaLerpY = this.lerpY\n    this.lerpY = lerp(this.lerpY, this.targetY, 0.1)\n    this.deltaLerpY -= this.lerpY\n\n    if (Math.abs(this.deltaLerpY) < 0.02) {\n      this.lerpY = this.targetY\n      this.deltaLerpY = 0\n    }\n\n    this.emit('scroll', {\n      y: ~~this.lerpY,\n      delta: this.deltaLerpY,\n      acceleration: this.deltaLerpY / SizesCache.window.height\n    })\n  }\n\n  onChange = () => {\n    this.deltaY = (window.scrollY || window.pageYOffset) - this.targetY\n    this.targetY += this.deltaY\n\n    if (!this.isEnabled) {\n      this.emit('scroll', {\n        y: this.targetY,\n        delta: this.deltaY,\n        acceleration: this.deltaY / SizesCache.window.height\n      })\n    }\n  }\n\n  listen() {\n    EventManager.on('raf', this.onRaf)\n    EventManager.on('scroll', this.onChange)\n    EventManager.on('resize', this.onChange)\n  }\n}\n"],"names":["isEnabled","lerpY","targetY","deltaLerpY","lerp","Math","abs","emit","y","delta","acceleration","SizesCache","window","height","deltaY","scrollY","pageYOffset","listen","EventManager","on","onRaf","onChange","EventEmitter"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAMA,YAAe;;AAAA;;;2BACC;;;;;;;4DAoBN,YAAM;UACR,CAAC,MAAKA,SAAN,IAAmB,MAAKC,KAAL,KAAe,MAAKC,OAA3C,EAAoD;YAE/CC,UAAL,GAAkB,MAAKF,KAAvB;YACKA,KAAL,GAAaG,IAAI,CAAC,MAAKH,KAAN,EAAa,MAAKC,OAAlB,EAA2B,GAA3B,CAAjB;YACKC,UAAL,IAAmB,MAAKF,KAAxB;;UAEII,IAAI,CAACC,GAAL,CAAS,MAAKH,UAAd,IAA4B,IAAhC,EAAsC;cAC/BF,KAAL,GAAa,MAAKC,OAAlB;cACKC,UAAL,GAAkB,CAAlB;;;YAGGI,IAAL,CAAU,QAAV,EAAoB;QAClBC,CAAC,EAAE,CAAC,CAAC,MAAKP,KADQ;QAElBQ,KAAK,EAAE,MAAKN,UAFM;QAGlBO,YAAY,EAAE,MAAKP,UAAL,GAAkBQ,UAAU,CAACC,MAAX,CAAkBC;OAHpD;KAhCY;;+DAuCH,YAAM;YACVC,MAAL,GAAc,CAACF,MAAM,CAACG,OAAP,IAAkBH,MAAM,CAACI,WAA1B,IAAyC,MAAKd,OAA5D;YACKA,OAAL,IAAgB,MAAKY,MAArB;;UAEI,CAAC,MAAKd,SAAV,EAAqB;cACdO,IAAL,CAAU,QAAV,EAAoB;UAClBC,CAAC,EAAE,MAAKN,OADU;UAElBO,KAAK,EAAE,MAAKK,MAFM;UAGlBJ,YAAY,EAAE,MAAKI,MAAL,GAAcH,UAAU,CAACC,MAAX,CAAkBC;SAHhD;;KA5CU;;UAGPX,OAAL,GAAe,MAAKD,KAAL,GAAcW,MAAM,CAACG,OAAP,IAAkBH,MAAM,CAACI,WAAtD;;UAEKT,IAAL,CAAU,QAAV,EAAoB;MAACC,CAAC,EAAE,MAAKN,OAAT;MAAkBO,KAAK,EAAE,CAAzB;MAA4BC,YAAY,EAAE;KAA9D;;UACKO,MAAL;;;GAPW;;;;;8BAWH;UACJ,CAAC,KAAKjB,SAAV,EAAqB;WAChBA,SAAL,GAAiB,KAAjB;;;;6BAGO;UACH,KAAKA,SAAT,EAAoB;WACfA,SAAL,GAAiB,IAAjB;;;;6BAmCO;MACPkB,YAAY,CAACC,EAAb,CAAgB,KAAhB,EAAuB,KAAKC,KAA5B;MACAF,YAAY,CAACC,EAAb,CAAgB,QAAhB,EAA0B,KAAKE,QAA/B;MACAH,YAAY,CAACC,EAAb,CAAgB,QAAhB,EAA0B,KAAKE,QAA/B;;;;;EAxD2CC,YAAhC,WAAf;;;;"}