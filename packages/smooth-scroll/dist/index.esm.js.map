{"version":3,"file":"index.esm.js","sources":["../index.js"],"sourcesContent":["import {cap} from '@okiba/math'\nimport ScrollManager from '@okiba/scroll-manager'\nimport EventManager from '@okiba/event-manager'\nimport SizesCache from '@okiba/sizes-cache'\n\nexport default class SmoothScroll {\n  constructor(el) {\n    this.el = el\n    this.sizes = SizesCache.get(this.el)\n    this.onResize()\n    this.listen()\n  }\n\n  disable() {\n    if (!this.isEnabled) return\n    this.isEnabled = false\n    this.el.style.transform = ''\n  }\n\n  enable() {\n    if (this.isEnabled) return\n    this.isEnabled = true\n    this.el.style.transform = `translate3d(0, -${this.y}px, 0)`\n  }\n\n  onRaf = () => {\n    if (!this.isEnabled) return\n    if (this.targetY === this.y) {\n      EventManager.off('raf', this.onRaf)\n      return\n    }\n\n    this.y = this.targetY\n    this.el.style.transform = `translate3d(0, -${this.y}px, 0)`\n  }\n\n  onScroll = ({y}) => {\n    this.targetY = cap(y, this.top, this.bottom)\n    if (this.targetY !== this.y) {\n      this.onRaf()\n      EventManager.on('raf', this.onRaf)\n      return\n    }\n  }\n\n  onResize = () => {\n    this.bottom = this.sizes.bottom\n    this.top = this.sizes.top - SizesCache.window.height\n  }\n\n  listen() {\n    EventManager.on('resize', this.onResize)\n    EventManager.on('raf', this.onRaf)\n    ScrollManager.on('scroll', this.onScroll)\n  }\n}\n"],"names":["SmoothScroll","el","isEnabled","targetY","y","EventManager","off","onRaf","style","transform","cap","top","bottom","on","sizes","SizesCache","window","height","get","onResize","listen","ScrollManager","onScroll"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;IAKqBA;;;wBACPC,EAAZ,EAAgB;;;;;mCAmBR,YAAM;UACR,CAAC,KAAI,CAACC,SAAV,EAAqB;;UACjB,KAAI,CAACC,OAAL,KAAiB,KAAI,CAACC,CAA1B,EAA6B;QAC3BC,YAAY,CAACC,GAAb,CAAiB,KAAjB,EAAwB,KAAI,CAACC,KAA7B;;;;MAIF,KAAI,CAACH,CAAL,GAAS,KAAI,CAACD,OAAd;MACA,KAAI,CAACF,EAAL,CAAQO,KAAR,CAAcC,SAAd,6BAA6C,KAAI,CAACL,CAAlD;KA3Bc;;sCA8BL,gBAAS;UAAPA,CAAO,QAAPA,CAAO;MAClB,KAAI,CAACD,OAAL,GAAeO,GAAG,CAACN,CAAD,EAAI,KAAI,CAACO,GAAT,EAAc,KAAI,CAACC,MAAnB,CAAlB;;UACI,KAAI,CAACT,OAAL,KAAiB,KAAI,CAACC,CAA1B,EAA6B;QAC3B,KAAI,CAACG,KAAL;;QACAF,YAAY,CAACQ,EAAb,CAAgB,KAAhB,EAAuB,KAAI,CAACN,KAA5B;;;KAlCY;;sCAuCL,YAAM;MACf,KAAI,CAACK,MAAL,GAAc,KAAI,CAACE,KAAL,CAAWF,MAAzB;MACA,KAAI,CAACD,GAAL,GAAW,KAAI,CAACG,KAAL,CAAWH,GAAX,GAAiBI,UAAU,CAACC,MAAX,CAAkBC,MAA9C;KAzCc;;SACThB,EAAL,GAAUA,EAAV;SACKa,KAAL,GAAaC,UAAU,CAACG,GAAX,CAAe,KAAKjB,EAApB,CAAb;SACKkB,QAAL;SACKC,MAAL;;;;;8BAGQ;UACJ,CAAC,KAAKlB,SAAV,EAAqB;WAChBA,SAAL,GAAiB,KAAjB;WACKD,EAAL,CAAQO,KAAR,CAAcC,SAAd,GAA0B,EAA1B;;;;6BAGO;UACH,KAAKP,SAAT,EAAoB;WACfA,SAAL,GAAiB,IAAjB;WACKD,EAAL,CAAQO,KAAR,CAAcC,SAAd,6BAA6C,KAAKL,CAAlD;;;;6BA4BO;MACPC,YAAY,CAACQ,EAAb,CAAgB,QAAhB,EAA0B,KAAKM,QAA/B;MACAd,YAAY,CAACQ,EAAb,CAAgB,KAAhB,EAAuB,KAAKN,KAA5B;MACAc,aAAa,CAACR,EAAd,CAAiB,QAAjB,EAA2B,KAAKS,QAAhC;;;;;;;;;"}